# ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

## v2.1 Release - Chat & API Fixes (2026-02-17)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: Chat endpoint –≤–æ–∑–≤—Ä–∞—â–∞–ª 502 Bad Gateway
**–ü—Ä–æ–±–ª–µ–º–∞**: Chat endpoint (`POST /api/chat`) –≤–æ–∑–≤—Ä–∞—â–∞–ª 502 –≤–º–µ—Å—Ç–æ 200, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î.

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
1. –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ docker logs ‚Üí –≤–∏–¥–Ω–æ, —á—Ç–æ SQL –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ environment variables ‚Üí GEMINI_API_KEY —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (39 —Å–∏–º–≤–æ–ª–æ–≤, —Ñ–æ—Ä–º–∞—Ç "AIza...")
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ GeminiService –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ ‚Üí –ø–æ–ª—É—á–∏–ª–∏ –æ—à–∏–±–∫—É:
   ```
   google.genai.errors.ClientError: 404 NOT_FOUND
   models/gemini-2.0-flash-exp is not found for API version v1beta
   ```

**–†–µ—à–µ–Ω–∏–µ**:
- –ó–∞–ø—É—Å—Ç–∏–ª–∏ `client.models.list()` ‚Üí –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –û–±–Ω–∞—Ä—É–∂–∏–ª–∏, —á—Ç–æ `gemini-2.0-flash-exp` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –∏–º—è)
- –ó–∞–º–µ–Ω–∏–ª–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å `gemini-2.0-flash` –≤ `backend/config/settings.py`:
  ```python
  GEMINI_MODEL: str = "gemini-2.0-flash"  # –±—ã–ª–æ: "gemini-2.0-flash-exp"
  ```
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: `docker compose up -d --force-recreate gateway worker`

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ
- `GET /api/health` ‚Üí 200 OK
- `GET /api/media` ‚Üí 200 OK
- `POST /api/search` ‚Üí 200 OK  
- `POST /api/chat` ‚Üí 200 OK (—Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç!)

**–ö–æ–º–º–∏—Ç**: `Fix: Replace invalid Gemini model (gemini-2.0-flash-exp) with supported gemini-2.0-flash model`

---

## v2.0 Release - Production Fixes (2026-02-17)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞
- **Frontend port**: –í—ã—Ä–æ–≤–Ω—è–ª—Å—è Vite dev —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç 5173 (–≤–º–µ—Å—Ç–æ 3000) –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å docker-compose
- **SQLAlchemy 2.x compatibility**: –û–±—ë—Ä–Ω—É—Ç—ã raw SQL –∑–∞–ø—Ä–æ—Å—ã –≤ `text()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ SQLAlchemy 2.0+
- **Gemini SDK**: –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–æ–≤–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π `google-genai` (–≤–º–µ—Å—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π `google-generativeai`)
- **Database indexes**: –†–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–º—ë–Ω –∏–Ω–¥–µ–∫—Å–æ–≤ (idx_status ‚Üí idx_media_status/idx_job_status)
- **API routing**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã API URLs –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ (`/api`) –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ Docker
- **Docker config**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω Whisper –≤ local —Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç OpenAI –∫–ª—é—á–∞)
- **Documentation**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–æ—Ä—Ç–∞–º –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è, –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è, API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000, UI –Ω–∞ http://localhost:5173

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ —Ç–≤–æ–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

### 1. ‚úÖ –£–±—Ä–∞–ª —Å—Ç–∞—Ä—ã–π –∫–æ–¥
- ‚ùå `db.ts` - —É–¥–∞–ª—ë–Ω (IndexedDB –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚ùå `geminiService.ts` - —É–¥–∞–ª—ë–Ω (–ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ backend)
- ‚ùå `whisperService.ts` - —É–¥–∞–ª—ë–Ω (–ø–µ—Ä–µ–Ω–µ—Å—ë–Ω –≤ backend)
- ‚ùå `transcriptionService.ts` - —É–¥–∞–ª—ë–Ω (–∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω –≤ backend)
- ‚ùå `App-old.tsx` - —É–¥–∞–ª—ë–Ω (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è –≤–µ—Ä—Å–∏—è)

### 2. ‚úÖ –î–æ–±–∞–≤–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚ú® `frontend/components/JobStatus.tsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å: pending / processing / completed / failed
  - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
  - –ò–∫–æ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ (‚è≥‚öôÔ∏è‚úÖ‚ùå)
  - –¢–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  - –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 3. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª WebSocket –¥–ª—è real-time updates
- ‚ú® `frontend/services/websocket.ts` - —Å–µ—Ä–≤–∏—Å WebSocket –∫–ª–∏–µ–Ω—Ç–∞
  - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ `/ws` endpoint
  - Subscribe/unsubscribe –Ω–∞ job updates
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
  - Callback-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  
- ‚ú® `backend/gateway/routers/websocket.py` - WebSocket endpoint
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ job updates
  - Broadcast –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞–º
  - –ü–æ–ª–ª–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∏–∑ –ë–î (–º–æ–∂–Ω–æ –ø–æ–∑–∂–µ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Celery events)
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ (ConnectionManager)

### 4. ‚úÖ –û–±–Ω–æ–≤–∏–ª frontend –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è WebSocket

#### `App.tsx`:
- ‚úÖ –£–±—Ä–∞–ª `pollJobStatus()` (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω)
- ‚úÖ –î–æ–±–∞–≤–∏–ª `wsService.connect()` –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚úÖ –î–æ–±–∞–≤–∏–ª `wsService.disconnect()` –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚úÖ Tracking –∞–∫—Ç–∏–≤–Ω—ã—Ö jobs —á–µ—Ä–µ–∑ state `processingJobs`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª `<JobStatus>` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ job
- ‚úÖ Callbacks –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è/–æ—à–∏–±–æ–∫ jobs

#### `api/client.ts`:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏–ª –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ChatResponse` (answer + sources –≤–º–µ—Å—Ç–æ response)
- ‚úÖ –û–±–Ω–æ–≤–∏–ª –º–µ—Ç–æ–¥ `chat()` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- ‚úÖ –ü–æ–ø—Ä–∞–≤–∏–ª –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `MediaItem` –ø–æ–¥ –±—ç–∫–µ–Ω–¥ —Å—Ö–µ–º—É

### 5. ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª –∫ –≤—ã–∫–ª–∞–¥–∫–µ –Ω–∞ GitHub
- ‚ú® `.gitignore` - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚ú® `README.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
  - –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏—á–µ–π
  - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
  - Quick Start –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
  - API endpoints
  - Deployment guide
  - Troubleshooting
  
- ‚ú® `CHANGELOG.md` - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π v2.0
- ‚ú® `PUSH_TO_GITHUB.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫–∞–∫ –∑–∞–ª–∏—Ç—å –Ω–∞ GitHub

### 6. ‚úÖ Git –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω remote –Ω–∞ `https://github.com/kitgriului/nexus-chat.git`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ —Ñ–∞–π–ª—ã
- ‚úÖ –°–¥–µ–ª–∞–Ω–æ 2 –∫–æ–º–º–∏—Ç–∞:
  1. "‚ú® Nexus v2.0: Production-ready architecture" - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  2. "üìù Add CHANGELOG and GitHub push instructions" - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–µ–±–µ:

### –ó–∞–ª–∏—Ç—å –Ω–∞ GitHub:

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏:

```bash
cd /path/to/Nexus  # —Ç–≤–æ–π –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
git push -u origin main --force
```

–ï—Å–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é - –∏—Å–ø–æ–ª—å–∑—É–π Personal Access Token (—Å–º. `PUSH_TO_GITHUB.md`).

–ü–æ—Å–ª–µ –ø—É—à–∞ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞:
**https://github.com/kitgriului/nexus-chat**

---

## –ò—Ç–æ–≥–æ:

‚úÖ –í–µ—Å—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ —É–¥–∞–ª—ë–Ω  
‚úÖ WebSocket –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (backend + frontend)  
‚úÖ JobStatus –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω  
‚úÖ App.tsx –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –ø–æ–¥ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É  
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞  
‚úÖ Git –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω  

**–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—à–∏—Ç—å –Ω–∞ GitHub! üöÄ**
